<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>LUA API | GameAI.win</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" type="image/png" size="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="description" content="GameAI.win 是一个工具集合，它可以帮助你更加轻松的游戏">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="apple-mobile-web-app-title" content="GameAI.win">
    <meta name="application-name" content="GameAI.win">
    <meta name="msapplication-TileColor" content="#da532c">
    
    <link rel="preload" href="/assets/css/0.styles.7bb3cdfd.css" as="style"><link rel="preload" href="/assets/js/app.26e9f14a.js" as="script"><link rel="preload" href="/assets/js/3.31c59f86.js" as="script"><link rel="preload" href="/assets/js/6.d38266fe.js" as="script"><link rel="preload" href="/assets/js/21.5902e715.js" as="script"><link rel="prefetch" href="/assets/js/10.8dec2686.js"><link rel="prefetch" href="/assets/js/11.115082b5.js"><link rel="prefetch" href="/assets/js/12.3daffb5c.js"><link rel="prefetch" href="/assets/js/13.086f814b.js"><link rel="prefetch" href="/assets/js/14.e3272c28.js"><link rel="prefetch" href="/assets/js/15.7fc7ed2a.js"><link rel="prefetch" href="/assets/js/16.f280ead7.js"><link rel="prefetch" href="/assets/js/17.e82ec0be.js"><link rel="prefetch" href="/assets/js/18.58f0e90e.js"><link rel="prefetch" href="/assets/js/19.6c432081.js"><link rel="prefetch" href="/assets/js/20.066ad05d.js"><link rel="prefetch" href="/assets/js/22.00940581.js"><link rel="prefetch" href="/assets/js/23.35f8f227.js"><link rel="prefetch" href="/assets/js/24.938814cb.js"><link rel="prefetch" href="/assets/js/25.d61245d0.js"><link rel="prefetch" href="/assets/js/26.c1e01ef1.js"><link rel="prefetch" href="/assets/js/27.f6b4b25a.js"><link rel="prefetch" href="/assets/js/28.52518340.js"><link rel="prefetch" href="/assets/js/29.f5cd8d24.js"><link rel="prefetch" href="/assets/js/4.8c65c393.js"><link rel="prefetch" href="/assets/js/5.ea4ca44a.js"><link rel="prefetch" href="/assets/js/7.d0320442.js"><link rel="prefetch" href="/assets/js/8.9bf02a95.js"><link rel="prefetch" href="/assets/js/9.5f1e60bb.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.ca16f66c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7bb3cdfd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zh_TW/" class="home-link router-link-active"><img src="/home.png" alt="GameAI.win" class="logo"> <span class="site-name can-hide">GameAI.win</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zh_TW/guide/start.html" class="nav-link">
  快速开始
</a></div><div class="nav-item"><a href="/zh_TW/developer/base.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  脚本编写
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh_TW/developer/base.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  English
</a></li></ul></div></div> <a href="https://github.com/gameai-win" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zh_TW/guide/start.html" class="nav-link">
  快速开始
</a></div><div class="nav-item"><a href="/zh_TW/developer/base.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  脚本编写
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh_TW/developer/base.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  English
</a></li></ul></div></div> <a href="https://github.com/gameai-win" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>LUA API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zh_TW/developer/base.html#基础库" class="sidebar-link">基础库</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zh_TW/developer/base.html#主机库" class="sidebar-link">主机库</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zh_TW/developer/base.html#基础介绍" class="sidebar-link">基础介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#脚本基础结构" class="sidebar-link">脚本基础结构</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#全局变量" class="sidebar-link">全局变量</a></li></ul></li><li><a href="/zh_TW/developer/base.html#全局函数" class="sidebar-link">全局函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#print" class="sidebar-link">print</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#wait" class="sidebar-link">wait</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#sleep" class="sidebar-link">sleep</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#load-module" class="sidebar-link">load_module</a></li></ul></li><li><a href="/zh_TW/developer/base.html#op" class="sidebar-link">op</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#ver" class="sidebar-link">Ver</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#setpath" class="sidebar-link">SetPath</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#findpic" class="sidebar-link">FindPic</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#capture" class="sidebar-link">Capture</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#setshowerrormsg" class="sidebar-link">SetShowErrorMsg</a></li></ul></li><li><a href="/zh_TW/developer/base.html#game" class="sidebar-link">game</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#loadres" class="sidebar-link">LoadRes</a></li></ul></li><li><a href="/zh_TW/developer/base.html#主机函数" class="sidebar-link">主机函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#xbox" class="sidebar-link">XBOX</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#playstation" class="sidebar-link">PlayStation</a></li><li class="sidebar-sub-header"><a href="/zh_TW/developer/base.html#switch" class="sidebar-link">Switch</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="lua-api"><a href="#lua-api" class="header-anchor">#</a> LUA API</h1> <ul><li>系统采用<a href="https://www.lua.org/manual/5.4/manual.html" target="_blank" rel="noopener noreferrer">Lua5.4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>实现。</li> <li>支持大部分原生lua函数(少数危险API例外)</li> <li>可以支持两种文件类型  编译好的 <code>.psr</code> 和 <code>.lua</code></li> <li>编译好的 <code>.psr</code> 是下载的成品脚本,里面包含了<code>受保护的</code>lua和res<code>资源</code>，无法改动</li> <li><code>.lua</code> 脚本是自己写的，可以改动</li> <li><code>.lua</code> 脚本写好后，你可以选择使用工具编译为 <code>.psr</code> 文件发布</li></ul> <h2 id="基础库"><a href="#基础库" class="header-anchor">#</a> 基础库</h2> <ul><li><a href="#op">op</a> 提供图色识别功能</li> <li><a href="#game">game</a> 提供主机操作功能</li></ul> <h2 id="主机库"><a href="#主机库" class="header-anchor">#</a> 主机库</h2> <ul><li><a href="/zh_TW/developer/xbox.html">xbox</a></li> <li><a href="/zh_TW/developer/playstation.html">playstation</a></li></ul> <h2 id="基础介绍"><a href="#基础介绍" class="header-anchor">#</a> 基础介绍</h2> <h3 id="脚本基础结构"><a href="#脚本基础结构" class="header-anchor">#</a> 脚本基础结构</h3> <ul><li>脚本由若干 LUA 文件与 res 目录组成</li> <li>脚本必须包含一个 <code>main</code> 函数</li> <li><div class="language-lua extra-class"><pre class="language-lua"><code>    <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">end</span>  
</code></pre></div><div class="language-lua extra-class"><pre class="language-lua"><code>    <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">end</span>  
</code></pre></div>脚本引擎启动时，会自动调用脚本中的 <code>main</code> 函数开始运行<br>
一个最简单的脚本:</li> <div class="language-lua extra-class"><pre class="language-lua"><code>    <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">end</span>  
</code></pre></div></ul> <div class="language-lua extra-class"><pre class="language-lua"><code>    <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">end</span>  
</code></pre></div><h3 id="全局变量"><a href="#全局变量" class="header-anchor">#</a> 全局变量</h3> <div class="language-lua extra-class"><pre class="language-lua"><code>  _APP_VERSION      <span class="token comment">-- 系统版本号  </span>
  _PATH             <span class="token comment">-- 当前脚本所在目录  </span>
  _FILENAME         <span class="token comment">-- 当前运行脚本的文件名(入口文件)  </span>
</code></pre></div><div class="language-lua extra-class"><pre class="language-lua"><code>  _APP_VERSION      <span class="token comment">-- 系统版本号  </span>
  _PATH             <span class="token comment">-- 当前脚本所在目录  </span>
  _FILENAME         <span class="token comment">-- 当前运行脚本的文件名(入口文件)  </span>
</code></pre></div><p>所有以下划线开头的变量都是系统变量，不能修改</p> <div class="language-lua extra-class"><pre class="language-lua"><code>  _APP_VERSION      <span class="token comment">-- 系统版本号  </span>
  _PATH             <span class="token comment">-- 当前脚本所在目录  </span>
  _FILENAME         <span class="token comment">-- 当前运行脚本的文件名(入口文件)  </span>
</code></pre></div><h2 id="全局函数"><a href="#全局函数" class="header-anchor">#</a> 全局函数</h2> <h3 id="print"><a href="#print" class="header-anchor">#</a> print</h3> <h4 id="函数简介"><a href="#函数简介" class="header-anchor">#</a> 函数简介:</h4> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><p>显示信息</p> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><h3 id="wait"><a href="#wait" class="header-anchor">#</a> wait</h3> <h4 id="函数简介-2"><a href="#函数简介-2" class="header-anchor">#</a> 函数简介:</h4> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment">-- 等待一秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token comment">-- 等待0.2秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment">-- 等待一秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token comment">-- 等待0.2秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><p>让脚本等待一定时间再向下运行</p> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment">-- 等待一秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token comment">-- 等待0.2秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><h3 id="sleep"><a href="#sleep" class="header-anchor">#</a> sleep</h3> <h4 id="函数简介-3"><a href="#函数简介-3" class="header-anchor">#</a> 函数简介:</h4> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>   <span class="token comment">-- 等待一秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment">-- 等待0.2秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>   <span class="token comment">-- 等待一秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment">-- 等待0.2秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><p>让脚本等待一定时间再向下运行,与上面的函数一样，只不过参数是毫秒</p> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>   <span class="token comment">-- 等待一秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment">-- 等待0.2秒  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><h3 id="load-module"><a href="#load-module" class="header-anchor">#</a> load_module</h3> <h4 id="load-a-module"><a href="#load-a-module" class="header-anchor">#</a> Load a module</h4> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token keyword">local</span> ret <span class="token operator">=</span> <span class="token function">load_module</span><span class="token punctuation">(</span> _PATH  <span class="token operator">..</span> <span class="token string">&quot;base.psr&quot;</span><span class="token punctuation">,</span>_ENV<span class="token punctuation">)</span>  
<span class="token keyword">if</span> ret <span class="token keyword">then</span>  
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;load module success&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">else</span>  
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;load module failed&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">end</span>  
</code></pre></div><div class="language-lua extra-class"><pre class="language-lua"><code><span class="token keyword">local</span> ret <span class="token operator">=</span> <span class="token function">load_module</span><span class="token punctuation">(</span> _PATH  <span class="token operator">..</span> <span class="token string">&quot;base.psr&quot;</span><span class="token punctuation">,</span>_ENV<span class="token punctuation">)</span>  
<span class="token keyword">if</span> ret <span class="token keyword">then</span>  
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;load module success&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">else</span>  
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;load module failed&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">end</span>  
</code></pre></div><p>加载一个三方库，成功加载以后，你可以使用三方库提供的功能函数</p> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token keyword">local</span> ret <span class="token operator">=</span> <span class="token function">load_module</span><span class="token punctuation">(</span> _PATH  <span class="token operator">..</span> <span class="token string">&quot;base.psr&quot;</span><span class="token punctuation">,</span>_ENV<span class="token punctuation">)</span>  
<span class="token keyword">if</span> ret <span class="token keyword">then</span>  
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;load module success&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">else</span>  
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;load module failed&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">end</span>  
</code></pre></div><hr> <h2 id="op"><a href="#op" class="header-anchor">#</a> op</h2> <h3 id="ver"><a href="#ver" class="header-anchor">#</a> Ver</h3> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span> op<span class="token punctuation">.</span><span class="token function">Ver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>   
</code></pre></div><div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span> op<span class="token punctuation">.</span><span class="token function">Ver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>   
</code></pre></div><p>返回当前op的版本号</p> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span> op<span class="token punctuation">.</span><span class="token function">Ver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>   
</code></pre></div><h3 id="setpath"><a href="#setpath" class="header-anchor">#</a> SetPath</h3> <div class="language-lua extra-class"><pre class="language-lua"><code>op<span class="token punctuation">.</span><span class="token function">SetPath</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\test\\res&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><div class="language-lua extra-class"><pre class="language-lua"><code>op<span class="token punctuation">.</span><span class="token function">SetPath</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\test\\res&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><p>设置全局路径,设置了此路径后,所有接口调用中,相关的文件都相对于此路径. 比如图片,字库等.</p> <div class="language-lua extra-class"><pre class="language-lua"><code>op<span class="token punctuation">.</span><span class="token function">SetPath</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\test\\res&quot;</span><span class="token punctuation">)</span>  
</code></pre></div><h3 id="findpic"><a href="#findpic" class="header-anchor">#</a> FindPic</h3> <h4 id="函数简介-4"><a href="#函数简介-4" class="header-anchor">#</a> 函数简介:</h4> <p>查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.</p> <p>这个函数可以查找多个图片,只返回第一个找到的X Y坐标.</p> <h4 id="函数原型"><a href="#函数原型" class="header-anchor">#</a> 函数原型:</h4> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">long</span> FindPic<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> pic_name<span class="token punctuation">,</span> delta_color<span class="token punctuation">,</span>sim<span class="token punctuation">,</span> dir<span class="token punctuation">,</span>intX<span class="token punctuation">,</span> intY<span class="token punctuation">)</span>  
</code></pre></div><h4 id="参数定义"><a href="#参数定义" class="header-anchor">#</a> 参数定义:</h4> <blockquote><p>x1 整形数:区域的左上X坐标<br>
y1 整形数:区域的左上Y坐标<br>
x2 整形数:区域的右下X坐标<br>
y2 整形数:区域的右下Y坐标<br>
pic_name 字符串:图片名,可以是多个图片,比如&quot;test.bmp|test2.bmp|test3.bmp&quot;<br>
delta_color 字符串:颜色色偏比如&quot;203040&quot; 表示RGB的色偏分别是20 30 40 (这里是16进制表示)<br>
sim 双精度浮点数:相似度,取值范围0.1-1.0<br>
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上<br>
intX 变参指针:返回图片左上角的X坐标<br>
intY 变参指针:返回图片左上角的Y坐标</p></blockquote> <h4 id="返回值"><a href="#返回值" class="header-anchor">#</a> 返回值:</h4> <p>整形数:</p> <blockquote><p>返回找到的图片的序号,从0开始索引.如果没找到返回-1</p></blockquote> <h4 id="示例"><a href="#示例" class="header-anchor">#</a> 示例:</h4> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token keyword">local</span> idx<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y <span class="token operator">=</span> op<span class="token punctuation">.</span><span class="token function">FindPic</span><span class="token punctuation">(</span><span class="token number">892</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">906</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token string">&quot;a.bmp&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;202020&quot;</span><span class="token punctuation">,</span><span class="token number">0.9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>  
<span class="token keyword">if</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">==</span> idx <span class="token keyword">then</span>   
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;没找到哦&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">else</span>  
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;找到了，坐标在&quot;</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>  
<span class="token keyword">end</span>  
</code></pre></div><h3 id="capture"><a href="#capture" class="header-anchor">#</a> Capture</h3> <h4 id="函数简介-5"><a href="#函数简介-5" class="header-anchor">#</a> 函数简介:</h4> <p>抓取指定区域(x1, y1, x2, y2)的图像,保存为file(24位位图)</p> <h4 id="函数原型-2"><a href="#函数原型-2" class="header-anchor">#</a> 函数原型:</h4> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">long</span> Capture<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> file<span class="token punctuation">)</span>  
</code></pre></div><h4 id="参数定义-2"><a href="#参数定义-2" class="header-anchor">#</a> 参数定义:</h4> <blockquote><p>x1 整形数:区域的左上X坐标<br>
y1 整形数:区域的左上Y坐标<br>
x2 整形数:区域的右下X坐标<br>
y2 整形数:区域的右下Y坐标<br>
file 字符串:保存的文件名,保存的地方一般为SetPath中设置的目录,当然这里也可以指定全路径名.</p></blockquote> <h4 id="返回值-2"><a href="#返回值-2" class="header-anchor">#</a> 返回值:</h4> <blockquote><p>0:失败<br>
1:成功</p></blockquote> <h4 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例:</h4> <div class="language-lua extra-class"><pre class="language-lua"><code>ret <span class="token operator">=</span> op<span class="token punctuation">.</span><span class="token function">Capture</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token string">&quot;screen.bmp&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">if</span> <span class="token number">1</span> <span class="token operator">==</span> ret <span class="token keyword">then</span>   
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;截图成功&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">end</span>  
</code></pre></div><h3 id="setshowerrormsg"><a href="#setshowerrormsg" class="header-anchor">#</a> SetShowErrorMsg</h3> <h4 id="函数简介-6"><a href="#函数简介-6" class="header-anchor">#</a> 函数简介:</h4> <p>设置是否弹出错误信息,默认是打开.</p> <h4 id="函数原型-3"><a href="#函数原型-3" class="header-anchor">#</a> 函数原型:</h4> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">long</span> SetShowErrorMsg<span class="token punctuation">(</span>show<span class="token punctuation">)</span>  
</code></pre></div><h4 id="参数定义-3"><a href="#参数定义-3" class="header-anchor">#</a> 参数定义:</h4> <p>show  0表示不打开,1表示打开，2表示将错误信息写入文件</p> <h4 id="返回值-3"><a href="#返回值-3" class="header-anchor">#</a> 返回值:</h4> <blockquote><p>0 : 失败<br>
1 : 成功</p></blockquote> <h4 id="示例-3"><a href="#示例-3" class="header-anchor">#</a> 示例:</h4> <div class="language-lua extra-class"><pre class="language-lua"><code>op_ret <span class="token operator">=</span> op<span class="token punctuation">.</span><span class="token function">SetShowErrorMsg</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  
</code></pre></div><hr> <h2 id="game"><a href="#game" class="header-anchor">#</a> game</h2> <h3 id="loadres"><a href="#loadres" class="header-anchor">#</a> LoadRes</h3> <div class="language-lua extra-class"><pre class="language-lua"><code>    <span class="token comment">-- 此处的 _PATH 是一个系统变量，指定当前运行脚本的目录  </span>
    <span class="token comment">-- 参数为路径，格式，_ENV (目前格式与_ENV为固定写法，照抄即可)  </span>
    <span class="token comment">-- 加载当前脚本目录下的 base.psr 模块    </span>
    game<span class="token punctuation">.</span><span class="token function">LoadRes</span><span class="token punctuation">(</span> _PATH <span class="token operator">..</span> <span class="token string">&quot;base.psr&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;bt&quot;</span><span class="token punctuation">,</span>_ENV<span class="token punctuation">)</span>  
    <span class="token comment">-- 加载后便可以调用base.psr中的函数了  </span>
</code></pre></div><div class="language-lua extra-class"><pre class="language-lua"><code>    <span class="token comment">-- 此处的 _PATH 是一个系统变量，指定当前运行脚本的目录  </span>
    <span class="token comment">-- 参数为路径，格式，_ENV (目前格式与_ENV为固定写法，照抄即可)  </span>
    <span class="token comment">-- 加载当前脚本目录下的 base.psr 模块    </span>
    game<span class="token punctuation">.</span><span class="token function">LoadRes</span><span class="token punctuation">(</span> _PATH <span class="token operator">..</span> <span class="token string">&quot;base.psr&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;bt&quot;</span><span class="token punctuation">,</span>_ENV<span class="token punctuation">)</span>  
    <span class="token comment">-- 加载后便可以调用base.psr中的函数了  </span>
</code></pre></div><p>加载一个脚本模块,加载之后便可以使用模块提供的函数</p> <div class="language-lua extra-class"><pre class="language-lua"><code>    <span class="token comment">-- 此处的 _PATH 是一个系统变量，指定当前运行脚本的目录  </span>
    <span class="token comment">-- 参数为路径，格式，_ENV (目前格式与_ENV为固定写法，照抄即可)  </span>
    <span class="token comment">-- 加载当前脚本目录下的 base.psr 模块    </span>
    game<span class="token punctuation">.</span><span class="token function">LoadRes</span><span class="token punctuation">(</span> _PATH <span class="token operator">..</span> <span class="token string">&quot;base.psr&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;bt&quot;</span><span class="token punctuation">,</span>_ENV<span class="token punctuation">)</span>  
    <span class="token comment">-- 加载后便可以调用base.psr中的函数了  </span>
</code></pre></div><h2 id="主机函数"><a href="#主机函数" class="header-anchor">#</a> 主机函数</h2> <p>好了，基础介绍完了，下面选择你的主机吧，开始介绍不同主机的特殊函数</p> <h3 id="xbox"><a href="#xbox" class="header-anchor">#</a> <a href="xbox">XBOX</a></h3> <h3 id="playstation"><a href="#playstation" class="header-anchor">#</a> <a href="playstation">PlayStation</a></h3> <h3 id="switch"><a href="#switch" class="header-anchor">#</a> <a href="switch">Switch</a></h3></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/gameai-win/gameai-win.github.io.git/edit/master/docs/zh_TW/developer/base.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/3/10 下午1:53:30</span></div></footer> <contributors></contributors> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.26e9f14a.js" defer></script><script src="/assets/js/3.31c59f86.js" defer></script><script src="/assets/js/6.d38266fe.js" defer></script><script src="/assets/js/21.5902e715.js" defer></script>
  </body>
</html>
